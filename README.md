# lua_srp6a
Provide a shared library for lua which contains the openssl srp6a implemention. And add the calculation of M1, M2 which openssl do not provide.

Here is a output of test_srp.lua:
* * *
Client ============== > Server:

username = username



Server ============== > Client:

N = EEAF0AB9ADB38DD69C33F80AFA8FC5E86072618775FF3C0B9EA2314C9C256576D674DF7496EA81D3383B4813D692C6E0E0D5D8E250B98BE48E495C1D6089DAD15DC7D7B46154D6B6CE8EF4AD69B15D4982559B297BCF1885C529F566660E57EC68EDBC3C05726CC02FD4CBF4976EAA9AFD5138FE8376435B9FC61D2FC0EB06E3

g = 2

s = F104D4813BEC5114929216F1D5C563582C6D8596



Client ============== > Server:

A = BBB8B086DFF776FEDCBE479487B3429D3E21433B45BE0ABE8198E83E225FFEFCE45E36BB9480C8FEA97789B5DDE48BF44EF201C416E89AB630B1A9034E4F1E1B77A20CB660C983842724942AD19046DB299E94E060D5F37A34D47FCAB97282772FC986B9208727C569DFEC51FB409CD6FF881D89B312603C1E1C1178D0016C51



Server verify A mod N: 1

Server ============== > Client:

B = E7FBD558FB7083F1AF75ABB6B3CB5791AEC1BE5FF4BEEDB8EA4991AF47CE9DBC5246B6CF696EEA63F77244441E73BDE92F8D4EF0B5E2768E8B3296242C9C2D7A876324379AAAB337CA8AC3A4B12274EA016B9EA59FCBE636A66725A7B28CEB6218F3D7861B30E24BDE03C3F9DC5C68E31C60F104A6D4783BD4EF5B896301239C



Client verify B mod N: 1

Client ============== > Server:

M1 = A2063DD1F9A8820BDE828B6D8BC283A91CCFD444


Server verify M1 match

Server ============== > Client:

M2 = F2C7C80CA3C378D5DF6FED81F6F6B384548B4133


Client verify M2 match 
* * *

I strongly recommend using lua_srp6a with [openresty](https://github.com/openresty/lua-nginx-module) for remote password verification.

# Reference:

[SRP6a wiki](https://en.wikipedia.org/wiki/Secure_Remote_Password_protocol)

[SRP Protocol Design](http://srp.stanford.edu/design.html)

[RFC 2945](http://www.ietf.org/rfc/rfc2945.txt)

[Openssl SRP](https://github.com/openssl/openssl/tree/OpenSSL_1_0_2-stable/crypto/srp)


